<!DOCTYPE html>
<html>
	<head>
		<!-- Standard Meta -->
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<title>svsh &middot; the supervisor shell</title>

		<link rel="stylesheet" type="text/css" href="semantic-ui/semantic.min.css" />
		<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Source+Code+Pro:500" />
		<link rel="stylesheet" type="text/css" href="svsh.css" />

		<script src="jquery-1.11.3.min.js"></script>
		<script src="semantic-ui/semantic.min.js"></script>
	</head>
	<body>
		<div class="ui large top fixed hidden menu">
			<div class="header item">
				<a href="/">svsh</a>
			</div>
			<a href="#home" class="active item">Home</a>
			<a href="#about" class="active item">About</a>
			<a href="#install" class="item">Install</a>
			<a href="#use" class="item">Use</a>
		</div>

		<a href="https://github.com/ido50/Svsh" rel="external">
			<img style="position: absolute; top: 49px; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png">
		</a>

		<div id="home" class="ui main container">
			<h1>svsh</h1>
			<h2>Take control of your supervisor</h2>
			<img class="ui centered bordered image" src="screenshot.png" alt="svsh" />
			<a class="ui labeled icon positive button" href="#install">
				<i class="download icon"></i>
				Get Started
			</a>
			<div class="ui label">
				latest version: 1.1.0
			</div>
		</div>

		<div id="about" class="ui container">
			<h1>About</h1>

			<p><strong>svsh</strong> is a free software command line shell for process supervision suites of the daemontools family. Currently, it supports <a href="http://cr.yp.to/daemontools.html" rel="external">daemontools</a>, <a href="http://b0llix.net/perp/" rel="external">perp</a>, <a href="http://www.skarnet.org/software/s6/index.html" rel="external">s6</a> and <a href="http://smarden.org/runit/" rel="external">runit</a>. It provides a unified interface allowing easy inspection and manipulation of services (i.e. processes) managed by these suites.</p>

			<p>With <strong>svsh</strong>, it is easy to get a complete view of your processes and their statuses. You can bring processes up, down, send them signals and view their output in real time. You don't need to remember the particular syntax of the control tools provided by your suite. Instead, you get a natural syntax that's easy to remember. Why execute <code>perpctl -b /services q nginx</code> when you can just type <code>restart nginx</code>?</p>

			<p><strong>svsh</strong> is written in Perl and currently targets UNIX-like operating systems that use procfs.</p>
		</div>

		<div id="install" class="ui container">
			<h1>Install</h1>

			<p><strong>svsh</strong> releases are hosted in <a href="https://metacpan.org/release/Svsh" rel="external">CPAN</a> and can be installed like any other Perl module.</p>

			<h2>with <a href="https://metacpan.org/pod/distribution/App-cpanminus/bin/cpanm" rel="external">cpanm</a>:</h2>
			<div class="ui segment">
				<p>$ cpanm -S Svsh</p>
			</div>

			<h2>with the cpan shell:</h2>
			<div class="ui segment">
				<p>$ cpan Svsh</p>
			</div>

			<h2>building manually:</h2>
			<p><a href="https://cpan.metacpan.org/authors/id/I/ID/IDOPEREL/Svsh-1.001000.tar.gz" rel="external">Download the tarball</a>, extract it, and build with:</p>
			<div class="ui segment">
				<p>$ perl Makefile.PL<br />$ make && make test<br />$ sudo make install</p>
			</div>
		</div>

		<div id="use" class="ui container">
			<h1>Use</h1>

			<p><strong>svsh</strong> is ready to rock right out of the box. No configuration or changes to your service directories are needed. Simply point it to your base directory (the directory from which your supervisor is running), and you instantly get a usable shell:</p>

			<div class="ui segment">
				<p>$ svsh --suite runit --basedir /etc/services</p>
			</div>

			<p>Once started, you get a list of all managed services, including their statuses, uptime or downtime durations, and process IDs.</p>

			<div class="ui segment">
				<pre><span style="background-color: #fff; color: #000">         process |     status | duration |   pid </span>
         <strong>haproxy</strong> |         <span style="color: #00D918">up</span> |     126s | 28444 
           <strong>nginx</strong> |       <span style="color: #E21100">down</span> |      12s |     -
        <strong>worker-1</strong> |         <span style="color: #00D918">up</span> |     126s | 28438 
        <strong>worker-2</strong> |         <span style="color: #00D918">up</span> |     126s | 28443 
        <strong>worker-3</strong> |         <span style="color: #00D918">up</span> |      55s | 28437 

svsh></pre>
			</div>

			<h2>Commands</h2>

			<p>The following commands are then available:</p>

			<table class="ui padded table">
				<tr>
					<th class="top aligned right aligned three wide" scope="row">status</th>
					<td class="thirteen wide">Prints an updated list of service statuses.</td>
				</tr>
				<tr>
					<th class="top aligned right aligned three wide" scope="row">start</th>
					<td class="thirteen wide">Starts a list of services, if they are not already up.<pre>svsh&gt; start nginx haproxy</pre></td>
				</tr>
				<tr>
					<th class="top aligned right aligned three wide" scope="row">stop</th>
					<td class="thirteen wide">Stops a list of services, if they are not already down. They will not be restarted.<pre>svsh&gt; stop nginx</pre></td>
				</tr>
				<tr>
					<th class="top aligned right aligned three wide" scope="row">restart</th>
					<td class="thirteen wide">Restarts a list of services. Most supervisors implement this with a <strong>QUIT</strong> signal.<pre>svsh&gt; restart worker*</pre></td>
				</tr>
				<tr>
					<th class="top aligned right aligned three wide" scope="row">signal</th>
					<td class="thirteen wide">Sends a UNIX signal to a list of services. Not all signals are supported by all supervisors.<pre>svsh&gt; signal hup nginx</pre></td>
				</tr>
				<tr>
					<th class="top aligned right aligned three wide" scope="row">fg</th>
					<td class="thirteen wide">Moves a service to the foreground, so that its output is followed on screen.<pre>svsh&gt; fg worker-2</pre></td>
				</tr>
				<tr>
					<th class="top aligned right aligned three wide" scope="row">toggle</th>
					<td class="thirteen wide">Toggles an <strong>svsh</strong> option. See list of options.<pre>svsh&gt; toggle collapse</pre></td>
				</tr>
			</table>

			<p>The following commands are implemented by <em>some</em> supervisors:</p>

			<table class="ui padded table">
				<tr>
					<th class="top aligned right aligned three wide" scope="row">rescan / update</th>
					<td class="thirteen wide">Causes the supervisor to rescan the base directory for new or removed services.</td>
				</tr>
				<tr>
					<th class="top aligned right aligned three wide" scope="row">terminate / shutdown</th>
					<td class="thirteen wide">Terminates the supervisor and all services.</td>
				</tr>
			</table>

			<h2>Log Inspection</h2>

			<p>All of the supported supervision suites do not enforce a logging scheme on managed
			services. While all of them provide a logging tool (daemontools provides multilog,
			perp provides tinylog and sissylog; s6 provides s6-log; runit
			provides svlogd), none of them enforce their usage. It is actually not uncommon
			among users of these suites to use a logging tool provided by one suite for services
			managed by another one. This means it is hard for an external program such as svsh
			to determine where log files are stored, if at all.</p>

			<p>Currently, <strong>svsh</strong> will attempt to find the log file of a service by checking the
			pid of the associated log process, and if (and only if) that process is one of the
			supported loggers (multilog, tinylog, s6-log or svlogd), it will try to find the
			file descriptor used by that process under <strong>/proc/&lt;pid&gt;/fd</strong>. As long as your services
			are being logged by one of these tools, svsh <em>should</em> be able to tail their log
			files when the fg command is used.</p>

			<h2>History and Auto-Completion</h2>

			<img class="ui centered bordered image" src="screenshot_history.png" alt="svsh" />

			<p><strong>svsh</strong> provides bash-like history so you can use your up arrow key to cycle back through past commands, or use Ctrl+R to search your history. The history file is saved under ~/.svsh_history.</p>

			<p>Also, autocompletion is provided for all commands. Tap the tab key at any moment while typing in commands and arguments, and <strong>svsh</strong> will attempt to autocomplete your current word, or display a list if multiple options are available.</p>

			<p>For this to work best, it is recommended to install <a href="https://metacpan.org/pod/Term::ReadLine::Gnu" rel="external">Term::ReadLine::Gnu</a>.

			<h2>Wildcards</h2>

			<p><strong>svsh</strong> makes it easy to manipulate multiple services at once. Wildcards are supported
			by the <code>start</code>, <code>stop</code>, <code>restart</code> and <code>signal</code> commands. If, for example, you have
			several services whose names start with "worker", you can stop them all by executing
			<code>stop worker*</code>. Wildcards are also supported at the beginning of the name, so
			<code>signal term *d</code> will send a TERM signal to all services whose names end with "d".</p>

			<div class="ui segment">
				<pre>    svsh&gt; status
<span style="background-color: #fff; color: #000">       process |     status | duration |   pid </span>
      <strong>worker-1</strong> |         <span style="color: #00D918">up</span> |    9813s | 25984
      <strong>worker-2</strong> |         <span style="color: #00D918">up</span> |    9813s | 25976
      <strong>worker-3</strong> |         <span style="color: #00D918">up</span> |    4393s | 2990

    svsh&gt; stop worker*

    svsh&gt; status
<span style="background-color: #fff; color: #000">       process |     status | duration |   pid </span>
      <strong>worker-1</strong> |       <span style="color: #E21100">down</span> |       2s |     -
      <strong>worker-2</strong> |       <span style="color: #E21100">down</span> |       2s |     -
      <strong>worker-3</strong> |       <span style="color: #E21100">down</span> |       2s |     -</pre>
			</div>

			<h2>Collapse</h2>

			<p>Often times you would like to run a certain service with X number of identical processes.
			None of the supervision suites have any mechanism to allow this (none that I
			know of at least), apart from creating identical copies of a service directory for every
			process needed. While <strong>svsh</strong> can't help you with that, it provides a nice feature for collapsing
			these identical services in the output of the <code>status</code> command to just one line. This can
			be very useful with lots of multi-process services.</p>

			<p>Currently, <strong>svsh</strong> determines multi-process services if their names are postfixed with a dash
			and a number. For example, if you have a service called "worker" that you need 3 processes
			of which to run, you can create "worker-1", "worker-2" and "worker-3" service directories.
			If the <code>collapse</code> option is on, <strong>svsh</strong> will collapse all of these into
			just one line, under the name status.</p>

			<div class="ui segment">
				<pre>    svsh&gt; status
<span style="background-color: #fff; color: #000">       process |     status | duration |   pid </span>
      <strong>worker-1</strong> |         <span style="color: #00D918">up</span> |    9813s | 25984
      <strong>worker-2</strong> |         <span style="color: #00D918">up</span> |    9813s | 25976
      <strong>worker-3</strong> |         <span style="color: #00D918">up</span> |    4393s | 2990

    svsh&gt; toggle collapse
<span style="background-color: #fff; color: #000">       process |     status | duration |   pid </span>
        <strong>worker</strong> |       <span style="color: #00D918">3 up</span> |    9850s |     -</pre>
			</div>
		</div>

		<div class="ui segment inverted footer">
			<p>&copy;Copyrights, 2015 Ido Perlmuter.</p>
		</div>
	</body>
</html>
